{{#if closed}}
  <button {{action (mut closed) (not closed)}} class="button hollow expanded no-margin hide-for-medium hide-for-print"> Edit Map Layers</button>
{{else}}
  <button {{action (mut closed) (not closed)}} class="close-button" aria-label="Close Map Layers" type="button"><span aria-hidden="true">&times;</span></button>
{{/if}}
<div id="layers-menu" class="{{if closed 'show-for-medium'}} hide-for-print">
  {{#layer-palette-accordion
    closed=false
    title='Zoning and Land Use'}}
    {{#layer-menu-item
      for='zoning-districts' as |item|}}
      {{#if item.layer.visible}}
        {{#item.multi-select
          column='primaryzone' as |multiSelect|}}
          {{#power-select-multiple
            options=(await
                (get-unique-options-for 'primaryzone' item.layer.config.sql)
              )
            selected=multiSelect.allChecked
            placeholder="Select Zones"
            onchange=(queue
                (action item.updateSql 'buildMultiSelectSQL' 'primaryzone')
                (action (mut multiSelect.allChecked))
              )
            as |name|}}
            {{name}}
          {{/power-select-multiple}}
        {{/item.multi-select}}
      {{/if}}
    {{/layer-menu-item}}

    {{#layer-menu-item for='pluto' as |item|}}
      {{#if (lt mainMap.currentZoom item.layer.minzoom)}}
        {{info-tooltip iconName='warning' tip='Zoom in more to see'}}
      {{/if}}
      {{#if item.layer.visible}}
        <div class="layer-menu-item"
          onclick={{queue
            (action 'toggleFill')
            (action item.updatePaintFor
              'pluto-fill'
              (if plutoFill (hash fill-opacity=0.7) (hash fill-opacity=0))
            )}}>
          {{input type='checkbox'
            checked=plutoFill}}
          Toggle Land Use Colors
        </div>
        {{#if plutoFill}}
        <ul class="layer-key">
          <li><span style="color:#FEFFA8;">{{fa-icon "square"}}</span>One &amp; Two Family Buildings</li>
          <li><span style="color:#FCB842;">{{fa-icon "square"}}</span>Multi-Family Walk-Up Buildings</li>
          <li><span style="color:#B16E00;">{{fa-icon "square"}}</span>Multi-Family Elevator Buildings</li>
          <li><span style="color:#ff8341;">{{fa-icon "square"}}</span>Mixed Residential &amp; Commercial Buildings</li>
          <li><span style="color:#fc2929;">{{fa-icon "square"}}</span>Commercial &amp; Office Buildings</li>
          <li><span style="color:#E362FB;">{{fa-icon "square"}}</span>Industrial &amp; Manufacturing</li>
          <li><span style="color:#E0BEEB;">{{fa-icon "square"}}</span>Transportation &amp; Utility</li>
          <li><span style="color:#44A3D5;">{{fa-icon "square"}}</span>Public Facilities &amp; Institutions</li>
          <li><span style="color:#78D271;">{{fa-icon "square"}}</span>Open Space &amp; Outdoor Recreation</li>
          <li><span style="color:#BAB8B6;">{{fa-icon "square"}}</span>Parking Facilities</li>
          <li><span style="color:#555555;">{{fa-icon "square"}}</span>Vacant Land</li>
          <li><span style="color:#222222;">{{fa-icon "square"}}</span>Other</li>
        </ul>
        {{/if}}
      {{/if}}
    {{/layer-menu-item}}

    {{#layer-menu-item
      for='commercial-overlays'
      as |item|}}
      {{#if item.layer.visible}}
        {{#layer-multi-select-control
          column='overlay'
          parentComponent=item.layer
          as |multiSelect|}}
            <ul class="layer-menu-item-controls">
              <li>
                <label>
                {{group-checkbox
                  refs=(array 'c14' 'c24' 'c22' 'c13' 'c23')
                  values=(array c14 c24 c22 c13 c23)
                  scope=this}} Select All
                </label>
                <ul class="nested">
                  <li>
                    <label>
                    {{multiSelect.checkbox
                        value='C1-4'
                        checked=c14}} C1-4
                    </label>
                  </li>
                  <li>
                    <label>
                    {{multiSelect.checkbox
                        value='C2-4'
                        checked=c24}} C2-4
                    </label>
                  </li>
                  <li>
                    <label>
                    {{multiSelect.checkbox
                        value='C2-2'
                        checked=c22}} C2-2
                    </label>
                  </li>
                  <li>
                    <label>
                    {{multiSelect.checkbox
                        value='C1-3'
                        checked=c13}} C1-3
                    </label>
                  </li>
                  <li>
                    <label>
                    {{multiSelect.checkbox
                        value='C2-3'
                        checked=c23}} C2-3
                    </label>
                  </li>
                </ul>
              </li>
            </ul>
        {{/layer-multi-select-control}}
      {{/if}}
    {{/layer-menu-item}}

    {{#layer-menu-item for='zoning-map-amendments' as |item|}}
      {{#if item.layer.visible}}
        {{item.range-slider
            column='effective'}}
      {{/if}}
    {{/layer-menu-item}}

    {{layer-menu-item for='zoning-map-amendments-pending'}}
  {{/layer-palette-accordion}}

  {{#layer-palette-accordion
    closed=true
    title='Supporting Zoning Layers'
    as |item|}}
    {{layer-menu-item
      for='special-purpose-districts'}}
    {{layer-menu-item
      for='special-purpose-subdistricts'}}
    {{layer-menu-item
      for='mandatory-inclusionary-housing'}}
    {{layer-menu-item
      for='inclusionary-housing'}}
    {{layer-menu-item
      for='transit-zones'}}
    {{layer-menu-item
      for='fresh'}}
    {{layer-menu-item
      for='sidewalkcafes'}}
    {{layer-menu-item
      for='low-density-growth-mgmt-areas'}}
    {{layer-menu-item
      for='coastal-zone-boundary'}}
    {{layer-menu-item
      for='waterfront-access-plan'}}
  {{/layer-palette-accordion}}
  {{#layer-palette-accordion
    closed=true
    title='Landmark & Historic'}}
    {{layer-menu-item
      for='sceniclandmarks'}}
    {{layer-menu-item
      for='historicdistricts'}}
    {{layer-menu-item
      for='landmarkpoints'}}
  {{/layer-palette-accordion}}
  {{#layer-palette-accordion
    closed=true
    title='Transportation'
  }}
    {{layer-menu-item
      for='subway'}}
  {{/layer-palette-accordion}}

  {{#layer-palette-accordion
    closed=true
    title='Administrative Boundaries'}}
    {{layer-menu-item
      for='boroughs'}}
    {{layer-menu-item
      for='communitydistricts'}}
    {{layer-menu-item
      for='nyccouncildistricts'}}
    {{layer-menu-item
      for='nysenatedistricts'}}
    {{layer-menu-item
      for='assemblydistricts'}}
    {{layer-menu-item
      for='neighborhood-tabulation-areas'}}
  {{/layer-palette-accordion}}

  {{#layer-palette-accordion
    closed=true
    title='Basemaps'}}
    {{layer-menu-item
      for='aerials16'}}
  {{/layer-palette-accordion}}
</div>
{{yield}}
