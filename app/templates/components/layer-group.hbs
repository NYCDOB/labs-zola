{{#if isReady}}
  {{#map.source
    sourceId=config.id
    options=sourceOptions as |source|}}
    {{#each config.layers as |layerConfig|}}
      {{source.layer
        layer=layerConfig.layer
        didUpdateLayers=didUpdateLayers
        before=before
      }}
    {{/each}}
  {{/map.source}}
{{/if}}

{{yield
  (hash
    timeline-control=
      (component 'layer-control-timeline' layer=
        (hash
          visible=visible
        )
        qps=qps
      )

    multi-select-control=
      (component 'layer-multi-select-control' layer=
        (hash
          visible=visible
        )
        qps=qps
      )
    tooltip=
      (component 'layer-tooltip' layer=
        (hash
          visible=visible
        )
      )
    visible=visible
    updateSql=(action 'updateSql')
    updatePaintFor=(action 'updatePaintFor')
    isPending=configWithTemplate.isPending
    toggleVisibility=(action 'toggleVisibility')
  )
}}
